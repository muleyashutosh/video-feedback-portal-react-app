(this["webpackJsonpvideo-feedback-portal"]=this["webpackJsonpvideo-feedback-portal"]||[]).push([[0],{68:function(e,t,n){},69:function(e,t,n){},81:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(9),i=n.n(r),s=(n(68),n(69),n(111)),o=n(113),l=n(114),d=n(129),u=n(128),j=n(25),b=n(4),p=Object(u.a)((function(e){return{root:{flexGrow:1},spread:{justifyContent:"space-between"},title:{flexGrow:1},white:{color:"white",textDecoration:"none"}}})),f=function(){var e=p();return Object(b.jsx)(s.a,{position:"static",children:Object(b.jsxs)(o.a,{className:e.root,children:[Object(b.jsx)(l.a,{variant:"h6",className:e.title,children:Object(b.jsx)(j.b,{className:e.white,to:"/video-feedback-portal-react-app/",children:"Feedback"})}),Object(b.jsx)(d.a,{color:"inherit",variant:"outlined",children:Object(b.jsx)(j.b,{className:e.white,to:"/video-feedback-portal-react-app/admin",children:"Admin"})})]})})},m=n(15),h=n.n(m),O=n(21),x=n(11),v=n(56),g=n.n(v),w="https://video-feedback-portal-server.cleverapps.io",y=n(18),S=n.n(y),N=(n(44),Object(u.a)((function(e){return{root:{flexGrow:1},video:{margin:"10px",width:"50%"},buttonContainer:{display:"grid",gap:"10px",gridTemplateColumns:"1fr 1fr",width:"50%",padding:"20px"},center:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}}}))),k=function(){var e=Object(a.useRef)(null),t=Object(a.useRef)(null),n=Object(a.useState)(!1),c=Object(x.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)([]),o=Object(x.a)(s,2),l=o[0],u=o[1],j=Object(a.useState)(""),p=Object(x.a)(j,2),f=p[0],m=p[1],v=Object(a.useState)(!0),y=Object(x.a)(v,2),k=y[0],C=y[1],I=Object(a.useState)(""),D=Object(x.a)(I,2),F=D[0],L=D[1],R=N(),E=function(e){var t=e.data;t.size>0&&u((function(e){return e.concat(t)}))};Object(a.useEffect)((function(){Object(O.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://geolocation-db.com/json/");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,L(n.IPv4);case 7:case"end":return e.stop()}}),e)})))()}),[F]);var P=function(){var e=Object(O.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S.a.start(),!l.length||!f){e.next=13;break}return t=new Blob(l,{type:"video/webm"}),(n=new FormData).append("video",t),n.append("ip",F),n.append("timestamp",(new Date).toLocaleString()),n.append("thumbnail",f),e.next=10,fetch("".concat(w,"/api/storeVideo"),{method:"post",body:n});case 10:u([]),m(""),C(!0);case 13:S.a.done();case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(b.jsxs)("div",{className:R.center,children:[Object(b.jsx)(g.a,{className:R.video,audio:!0,ref:e,mirrored:!0}),Object(b.jsxs)("div",{className:R.buttonContainer,children:[r?Object(b.jsx)(d.a,{color:"secondary",variant:"contained",onClick:function(){t.current.stop(),i(!1),C(!1)},children:"Stop"}):Object(b.jsx)(d.a,{color:"primary",variant:"contained",onClick:function(){i(!0),C(!0),t.current=new MediaRecorder(e.current.stream,{mimeType:"video/webm"}),t.current.addEventListener("dataavailable",E),t.current.start(),m(e.current.getScreenshot())},children:"Capture"}),Object(b.jsx)(d.a,{color:"primary",variant:"contained",disabled:k,onClick:P,children:"Submit"})]})]})},C=n(123),I=n(124),D=n(127),F=n(125),L=n(115),R=n(59),E=n(116),P=n(117),T=n(118),B=n(119),H=n(120),M=n(121),J=n(122);S.a.configure({showSpinner:!1});var U=Object(u.a)((function(e){return{table:{width:"100%"},container:{width:"95%",display:"flex",justifyContent:"flex-start",marginTop:e.spacing(3),marginRight:"auto",marginLeft:"auto",flexDirection:"column",overflowY:"hidden"},emptyMsg:{margin:e.spacing(2)},pointer:{cursor:"pointer"},loader:{width:"100%","& > * + *":{marginTop:e.spacing(2)}},tableHeading:{fontWeight:"bold",background:"#3f3f3f",color:"#fff",fontSize:"0.9rem"}}})),A=function(){var e=Object(a.useState)([]),t=Object(x.a)(e,2),n=t[0],c=t[1],r=U(),i=Object(a.useState)(!0),s=Object(x.a)(i,2),o=s[0],l=s[1];Object(a.useEffect)((function(){return Object(O.a)(h.a.mark((function e(){var t,n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(w,"/api/getEntries"));case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,a=n.data,c(a),l(!1);case 9:case"end":return e.stop()}}),e)})))()}),[c]);var d=n.map((function(e,t){var n=e.filename;return{id:t+1,thumbnail:e.image,timestamp:e.timestamp,ip:e.ip,filename:n}})),u=function(){var e=Object(O.a)(h.a.mark((function e(t){var n,a,c,r,i,s,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S.a.start(),e.next=3,fetch("".concat(w,"/video/").concat(t));case 3:return n=e.sent,e.next=6,n.json();case 6:return a=e.sent,c=a.video,e.next=10,fetch("data:video/webp;base64,".concat(c));case 10:return r=e.sent,e.next=13,r.blob();case 13:i=e.sent,s=document.createElement("a"),o=URL.createObjectURL(i),s.href=o,s.style.display="none",s.download="video.webm",document.body.appendChild(s),s.click(),URL.revokeObjectURL(o),document.body.removeChild(s),S.a.done();case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsx)(a.Fragment,{children:Object(b.jsxs)(L.a,{className:r.container,component:R.a,elevation:3,children:[o?Object(b.jsx)(E.a,{className:r.loader}):null,Object(b.jsxs)(P.a,{className:r.table,"aria-label":"simple table",loading:"true",children:[Object(b.jsx)(T.a,{children:Object(b.jsxs)(B.a,{children:[Object(b.jsx)(H.a,{className:r.tableHeading,children:"ID"}),Object(b.jsx)(H.a,{className:r.tableHeading,align:"center",children:"Video"}),Object(b.jsx)(H.a,{className:r.tableHeading,align:"center",children:"TimeStamp"}),Object(b.jsx)(H.a,{className:r.tableHeading,align:"center",children:"IP Address"}),Object(b.jsx)(H.a,{className:r.tableHeading,align:"center",children:"Download"})]})}),Object(b.jsx)(M.a,{children:0!==d.length||o?d.map((function(e,t){var n=e.filename,a=e.thumbnail,c=e.timestamp,i=e.ip;return Object(b.jsxs)(B.a,{children:[Object(b.jsx)(H.a,{component:"th",scope:"row",children:t+1}),Object(b.jsx)(H.a,{align:"center",children:Object(b.jsx)(j.b,{to:"/video-feedback-portal-react-app/video/".concat(n),target:"_blank",rel:"noopener noreferrer",children:Object(b.jsx)("img",{src:a,alt:"",style:{width:100,height:80}})})}),Object(b.jsx)(H.a,{align:"center",children:c}),Object(b.jsx)(H.a,{align:"center",children:i}),Object(b.jsx)(H.a,{align:"center",children:Object(b.jsx)(J.a,{className:r.pointer,onClick:function(){return u(n)}})})]},t+1)})):Object(b.jsx)(B.a,{className:r.emptyMsg,children:Object(b.jsx)(H.a,{children:"No Records to show yet"})})})]})]})})},G=Object(u.a)((function(e){return{root:{flexGrow:1,width:"fit-content",margin:"20px auto"},verticalAlign:{display:"flex",flexDirection:"column",alignItems:"center"},inputfield:{margin:e.spacing(3),marginBottom:e.spacing(.5)},button:{margin:e.spacing(2)},errMsg:{color:"#ea4335",margin:e.spacing(2)},signoutButton:{margin:e.spacing(2)},buttonContainer:{display:"flex",justifyContent:"flex-end"}}})),z=function(){var e=G(),t=Object(a.useState)(function(){var e=localStorage.getItem("verifiedStatus");return!!e&&JSON.parse(e).verified}()),n=Object(x.a)(t,2),c=n[0],r=n[1],i=Object(a.useState)(""),s=Object(x.a)(i,2),o=s[0],u=s[1],j=Object(a.useState)(""),p=Object(x.a)(j,2),f=p[0],m=p[1],v=Object(a.useState)(!1),g=Object(x.a)(v,2),y=g[0],N=g[1];S.a.configure({showSpinner:!1}),Object(a.useEffect)((function(){localStorage.setItem("verifiedStatus",JSON.stringify({verified:c}))}),[c]);var k=function(){var e=Object(O.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S.a.start(),t.preventDefault(),e.next=4,fetch("".concat(w,"/api/signin"),{headers:{"Content-Type":"application/json"},method:"post",body:JSON.stringify({username:o,password:f})});case 4:return n=e.sent,e.next=7,n.json();case 7:"OK"===e.sent.status?r(!0):N(!0),S.a.done();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsx)(a.Fragment,{children:c?Object(b.jsxs)(a.Fragment,{children:[Object(b.jsx)("div",{className:e.buttonContainer,children:Object(b.jsx)(d.a,{onClick:function(){S.a.start(),r(!1),N(!1),S.a.done()},variant:"contained",color:"secondary",className:e.signoutButton,children:"Signout"})}),Object(b.jsx)(A,{})]}):Object(b.jsxs)(C.a,{className:e.root,elevation:2,children:[Object(b.jsxs)(I.a,{className:e.verticalAlign,children:[Object(b.jsx)(D.a,{variant:"filled",error:y,onChange:function(e){var t=e.target;u(t.value)},className:e.inputfield,id:"username",label:"Username",required:!0}),Object(b.jsx)(D.a,{variant:"filled",type:"password",error:y,onChange:function(e){var t=e.target;m(t.value)},className:e.inputfield,id:"password",label:"Password",required:!0}),y?Object(b.jsx)(l.a,{variant:"body1",className:e.errMsg,children:"Invalid Credentials"}):null]}),Object(b.jsx)(F.a,{children:Object(b.jsx)(d.a,{onClick:k,color:"primary",variant:"contained",className:e.button,size:"medium",children:"Submit"})})]})})},q=n(13),V=Object(u.a)((function(e){return{videoParent:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"}}})),K=function(){var e=V(),t=Object(q.f)().filename,n=Object(a.useState)(""),c=Object(x.a)(n,2),r=c[0],i=c[1];return Object(a.useEffect)((function(){Object(O.a)(h.a.mark((function e(){var n,a,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(w,"/video/").concat(t));case 2:return n=e.sent,e.next=5,n.json();case 5:a=e.sent,c=a.video,i("data:video/webm;base64,".concat(c));case 8:case"end":return e.stop()}}),e)})))()})),Object(b.jsx)("div",{className:e.videoParent,children:Object(b.jsx)("video",{autoPlay:!0,controls:!0,src:r,loading:"true"})})},W=function(){return Object(b.jsx)(j.a,{children:Object(b.jsxs)(a.Fragment,{children:[Object(b.jsx)(f,{}),Object(b.jsxs)(q.c,{children:[Object(b.jsx)(q.a,{exact:!0,path:"/video-feedback-portal-react-app/",children:Object(b.jsx)(k,{})}),Object(b.jsx)(q.a,{path:"/video-feedback-portal-react-app/admin",children:Object(b.jsx)(z,{})}),Object(b.jsx)(q.a,{path:"/video-feedback-portal-react-app/video/:filename",children:Object(b.jsx)(K,{})})]})]})})},Y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,131)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))},_=n(57),Q=n(130),X=n(126),Z=Object(_.a)({palette:{primary:{main:"#1769aa"},secondary:{main:"#ab003c"}}});Z=Object(Q.a)(Z),i.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(X.a,{theme:Z,children:Object(b.jsx)(W,{})})}),document.getElementById("root")),Y()}},[[81,1,2]]]);
//# sourceMappingURL=main.1ea23d20.chunk.js.map